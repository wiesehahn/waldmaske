---
# title: "compare forest masks"
author: "wiesehahn"
date: "2021-04-12"
output: html_document
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(# fig.width=12, fig.height=8, 
  echo=FALSE, warning=FALSE, message=FALSE)
```

```{r}
library(here)
library(spdplyr)
library(mapview)
```

```{r}
load(here("data/interim/bwi_ni_extracted.rda"))
load(here("data/interim/bwi_ni_accuracy.rda"))
```

## Waldmasken im Vergleich

frei verfügbare Waldmasken wurden asugewählt

- Basis-Digitales Landschaftsmodell (DLM)
- Copernicus High Resolution Layer (HRL)
- Mundialis Incora
- Random Forest & Open Street Map (RF-OSM)


### Genauigkeitstabelle

Basierend auf den Daten der dritten Bundeswaldinventur wurden Genauigkeitsmetriken der Waldmasken errechnet.

```{r}
comparison_table %>%
  knitr::kable("html", escape = F, rownames = T, digits = 2)%>%
  kableExtra::kable_styling("hover", full_width = F)
```
### Differenzen zur BWI {.tabset .tabset-pills} 

Visualisierung der Stichprobenpunkte mit Differenzen zwischen der Bundeswaldinventur und den Waldmasken.

#### BWI - Basis-DLM
```{r plot_bwi_dlm, fig.cap= "Unterschiede zwischen BWI und Basis-DLM"}

bwi_dlm <- ref_comp %>% mutate(wald = ifelse(bwi=="1" & basis_dlm == "0", "nur BWI",
                                             ifelse(bwi=="0" & basis_dlm =="1", "nur DLM", 
                                                    ifelse(bwi=="0" & basis_dlm =="0", "kein Wald", "Wald")))) %>%
  select(bwi, basis_dlm, wald)



  mapview(bwi_dlm %>% filter(wald == "Wald"), layer.name ="beide Wald", alpha = 0.2, alpha.regions=0, cex=1, col.regions = "grey") +
    mapview(bwi_dlm %>% filter(wald %in% c("nur BWI", "nur DLM")), zcol="wald", layer.name ="Differenzen", cex = 4)

```

#### BWI - Copernicus HRL
```{r plot_bwi_hrl, fig.cap= "Unterschiede zwischen BWI und Copernicus HRL"}

bwi_hrl <- ref_comp %>% mutate(wald = ifelse(bwi=="1" & copernicus_hrl == "0", "nur BWI",
                                             ifelse(bwi=="0" & copernicus_hrl =="1", "nur HRL", 
                                                    ifelse(bwi=="0" & copernicus_hrl =="0", "kein Wald", "Wald")))) %>%
  select(bwi, copernicus_hrl, wald)



  mapview(bwi_hrl %>% filter(wald == "Wald"), layer.name ="beide Wald", alpha = 0.2, alpha.regions=0, cex=1, col.regions = "grey") +
    mapview(bwi_hrl %>% filter(wald %in% c("nur BWI", "nur HRL")), zcol="wald", layer.name ="Differenzen", cex = 4)

```

#### BWI - Mundialis
```{r plot_bwi_mdl, fig.cap= "Unterschiede zwischen BWI und Mundialis"}

bwi_mdl <- ref_comp %>% mutate(wald = ifelse(bwi=="1" & mundialis == "0", "nur BWI",
                                             ifelse(bwi=="0" & mundialis =="1", "nur Mundialis", 
                                                    ifelse(bwi=="0" & mundialis =="0", "kein Wald", "Wald")))) %>%
  select(bwi, mundialis, wald)



  mapview(bwi_mdl %>% filter(wald == "Wald"), layer.name ="beide Wald", alpha = 0.2, alpha.regions=0, cex=1, col.regions = "grey") +
    mapview(bwi_mdl %>% filter(wald %in% c("nur BWI", "nur Mundialis")), zcol="wald", layer.name ="Differenzen", cex = 4)

```

